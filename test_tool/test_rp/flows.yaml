---
Flows:
  RP-Code-RS256:
    profiles:
      - C
    desc: Simple code profile with RS256 signatures
    sequence:
      - Init:
          set_start_page: ''
          add_post_condition:
            http_response:
                status_code:
                  - 302
                  - 303
      - ConfigurationResponse
      - RegistrationResponse:
          add_pre_condition:
            verify-registration-response_types:
              allowed:
                - code
            verify-registration-redirect_uri-scheme: null
            verify-registration-public_key-registration: null
      - AuthorizationResponse:
          add_pre_condition:
            verify-authorization-offline-access: null
            verify-authorization-state-entropy: null
            verify-authorization-redirect_uri: null
      - AccessTokenResponse
  RP-Code-ES256:
    profiles:
      - C
    desc: Simple code profile with ES256 signatures
    sequence:
      - Init:
          set_start_page: ''
          add_post_condition:
            http_response:
                status_code:
                  - 302
                  - 303
          set_configuration:
            request_object_signing_alg_values_supported:
              - ES256
            id_token_signing_alg_values_supported:
              - ES256
            token_endpoint_auth_signing_alg_values_supported:
              - ES256
          set_op:
            jwx_def:
              signing_alg:
                id_token: ES256
      - ConfigurationResponse
      - RegistrationResponse:
          add_pre_condition:
            verify-registration-response_types:
              allowed:
                - code
            verify-registration-redirect_uri-scheme: null
            verify-registration-public_key-registration: null
      - AuthorizationResponse:
          add_pre_condition:
            verify-authorization-offline-access: null
            verify-authorization-state-entropy: null
            verify-authorization-redirect_uri: null
      - AccessTokenResponse
  RP-Token-RS256:
    profiles:
      - T
    desc: Simple token profile with RS256 signatures
    sequence:
      - init:
          set_start_page: ''
          add_post_condition:
            http_response:
                status_code:
                  - 302
                  - 303
      - ConfigurationResponse
      - RegistrationResponse:
          add_pre_condition:
            verify-registration-response_types:
              allowed:
                - token
            verify-registration-redirect_uri-scheme: null
            verify-registration-public_key-registration: null
      - AuthorizationResponse:
          add_pre_condition:
            verify-authorization-offline-access: null
            verify-authorization-state-entropy: null
            verify-authorization-redirect_uri: null
  RP-Token-ES256:
    profiles:
      - T
    desc: Simple token profile with ES256 signatures
    sequence:
      - Init:
          set_start_page: ''
          add_post_condition:
            http_response:
                status_code:
                  - 302
                  - 303
          set_configuration:
            request_object_signing_alg_values_supported:
              - ES256
            id_token_signing_alg_values_supported:
              - ES256
          set_op:
            jwx_def:
              signing_alg:
                id_token: ES256
      - ConfigurationResponse
      - RegistrationResponse:
          add_pre_condition:
            verify-registration-response_types:
              allowed:
                - token
            verify-registration-redirect_uri-scheme: null
            verify-registration-public_key-registration: null
      - AuthorizationResponse:
          add_pre_condition:
            verify-authorization-offline-access: null
            verify-authorization-state-entropy: null
            verify-authorization-redirect_uri: null
Order:
  - RP-Code
  - RP-Token
Desc:
  Code: Different signing algorithms using Code flow
  Token: Different signing algorithms using Implicit flow